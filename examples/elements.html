<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>signal/elements</title>
    <script type="importmap">
      {
        "imports": {
          "signal": "../packages/signal/mod.js",
          "signal/create_element": "../packages/create_element/mod.js"
        }
      }
    </script>
    <script type="module">
      import {
        createSignal,
        createScope,
        createEffect,
        onCleanup,
        onMount,
      } from "signal";
      import {
        createElement,
        createListener,
        createFragment,
        createDynamic,
        createText,
        render,
      } from "signal/create_element";

      const App = () => {
        const counter = createSignal(0);
        let id;
        onMount(() => {
          id = setInterval(() => {
            counter(counter() + 1);
          }, 1000);
        });
        onCleanup(() => clearInterval(id));

        createFragment(() => {
          createElement("h1", (elt) => {
            elt.textContent = "signal/elements";
          });
          createElement("main", () => {
            createElement("div", (elt) => {
              elt.textContent = () => String(counter());
              createListener("click", () => counter(counter() + 1));
            });
            createElement("button", (elt) => {
              elt.textContent = "Stop Effects";
              createListener("click", () => stopEffects());
            });
          });
        });

        createDynamic(() => {
          if (counter() % 2 === 0) {
            createText("even");
          }
        });
      };

      const stopEffects = render(document.body, () => {
        createElement("main", () => {
          App();
        });
      });
    </script>
  </head>
  <body></body>
</html>
