<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>signal/</title>
    <!-- for developing
      <script type="importmap">
      {
        "imports": {
          "signal": "./packages/signal/mod.js",
          "signal/router": "./packages/router/mod.js",
          "signal/dom": "./packages/dom/mod.js"
        }
      }
    </script>-->
    <script type="importmap">
      {
        "imports": {
          "signal": "https://cdn.jsdelivr.net/gh/mini-jail/signal@main/packages/signal/mod.js",
          "signal/router": "https://cdn.jsdelivr.net/gh/mini-jail/signal@main/packages/router/mod.js",
          "signal/dom": "https://cdn.jsdelivr.net/gh/mini-jail/signal@main/packages/dom/mod.js"
        }
      }
    </script>
    <link href="./assets/ark-pixel-font.css" media="all" rel="stylesheet" />
    <link href="./assets/app.css" media="all" rel="stylesheet" />
    <script type="module">
      import { createEffect, onMount } from "signal";
      import { pathSignal, createRouter } from "signal/router";
      import { template, render } from "signal/dom";

      import Home from "./routes/home.js";
      import Counter from "./routes/counter.js";
      import Sierpinski from "./routes/sierpinski.js";
      import About from "./routes/about.js";
      import Todo from "./routes/todo.js";
      import NotFound from "./routes/notfound.js";

      const App = () => {
        const getHash = () => location.hash.slice(1) || "/";

        onMount(() => {
          pathSignal(getHash());
          addEventListener("hashchange", () => pathSignal(getHash()));
        });

        createEffect(() => {
          document.title = `signal${pathSignal()}`;
        });

        const Router = createRouter({
          "/": Home,
          "/counter": Counter,
          "/sierpinski": Sierpinski,
          "/sierpinski/:target": Sierpinski,
          "/sierpinski/:target/:size": Sierpinski,
          "/about": About,
          "/todo": Todo,
          "/:url": NotFound,
        });

        return template`
          <header>
            <h3>signal${pathSignal}</h3>
            <nav>
              <a href="#/">home</a>
              <a href="#/counter">counter</a>
              <a href="#/sierpinski">sierpinski</a>
              <a href="#/todo">todo</a>
              <a href="#/about">about</a>
              <a href="#/error">error</a>
            </nav>
          </header>
          <main>
            ${Router}
          </main>
        `;
      };

      render(document.body, App);
    </script>
  </head>
  <body></body>
</html>
